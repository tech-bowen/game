<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>丰富的贪吃蛇游戏</title>
<style>
    body {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        background-color: #f0f0f0;
        font-family: Arial, sans-serif;
    }
    #game-board {
        width: 300px;
        height: 300px;
        border: 1px solid #ccc;
        position: relative;
        background-color: #fff;
    }
    .snake {
        width: 10px;
        height: 10px;
        background-color: #333;
        position: absolute;
    }
    .food {
        width: 10px;
        height: 10px;
        background-color: red;
        position: absolute;
    }
    #score-board {
        position: absolute;
        top: 10px;
        left: 10px;
        color: #333;
    }
    #message {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: rgba(0, 0, 0, 0.7);
        color: #fff;
        padding: 20px;
        border-radius: 10px;
        display: none;
    }
    #message.show {
        display: block;
    }
</style>
</head>
<body>
<div id="game-board">
    <div id="score-board">得分: 0</div>
    <div id="message">游戏结束！按 Enter 键重新开始</div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const board = document.getElementById('game-board');
        const scoreBoard = document.getElementById('score-board');
        const message = document.getElementById('message');
        const boardWidth = parseInt(getComputedStyle(board).width);
        const boardHeight = parseInt(getComputedStyle(board).height);
        const snakeSize = 10;
        const initialSnakeLength = 5;
        let snake = [];
        let food = {};
        let score = 0;
        let direction = 'right';
        let gameInterval;
        let isGameRunning = false;

        // 初始化游戏
        function initializeGame() {
            snake = [];
            const startX = Math.floor(boardWidth / snakeSize / 2);
            const startY = Math.floor(boardHeight / snakeSize / 2);
            for (let i = 0; i < initialSnakeLength; i++) {
                snake.push({ x: startX - i, y: startY });
            }
            score = 0;
            direction = 'right';
            renderSnake();
            generateFood();
            updateScore();
            message.classList.remove('show');
        }

        // 渲染蛇
        function renderSnake() {
            const snakeElements = document.querySelectorAll('.snake');
            snakeElements.forEach(element => element.remove());
            snake.forEach(segment => {
                const snakeElement = document.createElement('div');
                snakeElement.className = 'snake';
                snakeElement.style.left = segment.x * snakeSize + 'px';
                snakeElement.style.top = segment.y * snakeSize + 'px';
                board.appendChild(snakeElement);
            });
        }

        // 生成食物
        function generateFood() {
            let foodX, foodY, isValidPosition;
            do {
                isValidPosition = true;
                foodX = Math.floor(Math.random() * (boardWidth / snakeSize));
                foodY = Math.floor(Math.random() * (boardHeight / snakeSize));
                // 确保食物不会生成在蛇身体上
                for (const segment of snake) {
                    if (segment.x === foodX && segment.y === foodY) {
                        isValidPosition = false;
                        break;
                    }
                }
            } while (!isValidPosition);
            food = { x: foodX, y: foodY };
            const foodElement = document.createElement('div');
            foodElement.className = 'food';
            foodElement.style.left = food.x * snakeSize + 'px';
            foodElement.style.top = food.y * snakeSize + 'px';
            board.appendChild(foodElement);
        }

        // 移动蛇
        function moveSnake() {
            const head = { x: snake[0].x, y: snake[0].y };
            switch (direction) {
                case 'up':
                    head.y -= 1;
                    break;
                case 'down':
                    head.y += 1;
                    break;
                case 'left':
                    head.x -= 1;
                    break;
                case 'right':
                    head.x += 1;
                    break;
            }
            snake.unshift(head);

            // 检查蛇是否吃到食物
            if (head.x === food.x && head.y === food.y) {
                generateFood();
                score += 10;
                updateScore();
            } else {
                snake.pop();
            }

            if (isCollision(head)) {
                endGame();
                return;
            }

            renderSnake();
        }

        // 检查碰撞
        function isCollision(head) {
            // 检查是否撞墙
            if (head.x < 0 || head.x >= boardWidth / snakeSize || head.y < 0 || head.y >= boardHeight / snakeSize) {
                return true;
            }
            // 检查是否撞到自己
            for (let i = 1; i < snake.length; i++) {
                if (head.x === snake[i].x && head.y === snake[i].y) {
                    return true;
                }
            }
            return false;
        }

        // 更新得分
        function updateScore() {
            scoreBoard.textContent = '得分: ' + score;
        }

        // 结束游戏
        function endGame() {
            clearInterval(gameInterval);
            isGameRunning = false;
            message.classList.add('show');
        }

        // 开始游戏
        function startGame() {
            if (isGameRunning) return;
            isGameRunning = true;
            initializeGame();
            gameInterval = setInterval(moveSnake, 100); // 调整游戏速度（数值越小越快）
        }

        // 键盘控制方向
        document.addEventListener('keydown', (event) => {
            const key = event.key.toLowerCase();
            switch (key) {
                case 'arrowup':
                case 'w':
                    if (direction !== 'down') direction = 'up';
                    break;
                case 'arrowdown':
                case 's':
                    if (direction !== 'up') direction = 'down';
                    break;
                case 'arrowleft':
                case 'a':
                    if (direction !== 'right') direction = 'left';
                    break;
                case 'arrowright':
                case 'd':
                    if (direction !== 'left') direction = 'right';
                    break;
                case 'enter':
                    startGame();
                    break;
            }
        });

        // 初始化游戏
        initializeGame();
    });
</script>
</body>
</html>
