<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>丰富的贪吃蛇游戏</title>
<style>
    body {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        background-color: #f0f0f0;
        font-family: Arial, sans-serif;
    }
    #game-board {
        width: 300px;
        height: 300px;
        border: 1px solid #ccc;
        position: relative;
        background-color: #fff;
    }
    .snake {
        width: 10px;
        height: 10px;
        background-color: #333;
        position: absolute;
    }
    .food {
        width: 10px;
        height: 10px;
        background-color: red;
        position: absolute;
    }
    #score-board {
        position: absolute;
        top: 10px;
        left: 10px;
        color: #333;
    }
    #message {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: rgba(0, 0, 0, 0.7);
        color: #fff;
        padding: 20px;
        border-radius: 10px;
        display: none;
    }
    #message.show {
        display: block;
    }
</style>
</head>
<body>
<div id="game-board">
    <div id="score-board">得分: 0</div>
    <div id="message">游戏结束！按 Enter 键重新开始</div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const board = document.getElementById('game-board');
        const scoreBoard = document.getElementById('score-board');
        const message = document.getElementById('message');
        const boardWidth = parseInt(getComputedStyle(board).width);
        const boardHeight = parseInt(getComputedStyle(board).height);
        const snakeSize = 10;
        const initialSnakeLength = 5;
        let snake = [];
        let food = {};
        let score = 0;
        let direction = 'right';
        let gameInterval;
        let isGameRunning = false;

        function initializeGame() {
            snake = [];
            const startX = Math.floor(boardWidth / snakeSize / 2);
            const startY = Math.floor(boardHeight / snakeSize / 2);
            for (let i = 0; i < initialSnakeLength; i++) {
                snake.push({ x: startX - i, y: startY });
            }
            score = 0;
            direction = 'right';
            renderSnake();
            generateFood();
            updateScore();
            message.classList.remove('show');
        }

        function renderSnake() {
            const snakeElements = document.querySelectorAll('.snake');
            snakeElements.forEach(element => element.remove());
            snake.forEach(segment => {
                const snakeElement = document.createElement('div');
                snakeElement.className = 'snake';
                snakeElement.style.left = segment.x * snakeSize + 'px';
                snakeElement.style.top = segment.y * snakeSize + 'px';
                board.appendChild(snakeElement);
            });
        }

        function generateFood() {
            let foodX, foodY, isValidPosition;
            do {
                isValidPosition = true;
                foodX = Math.floor(Math.random() * (boardWidth / snakeSize));
                foodY = Math.floor(Math.random() * (boardHeight / snakeSize));
                // 确保食物不会生成在蛇身体上
                for (const segment of snake) {
                    if (segment.x === foodX && segment.y === foodY) {
                        isValidPosition = false;
                        break;
                    }
                }
            } while (!isValidPosition);
            food = { x: foodX, y: foodY };
            const foodElement = document.createElement('div');
            foodElement.className = 'food';
            foodElement.style.left = food.x * snakeSize + 'px';
            foodElement.style.top = food.y * snakeSize + 'px';
            board.appendChild(foodElement);
        }

        function moveSnake() {
            const head = { x: snake[0].x, y: snake[0].y };
            switch (direction) {
                case 'up':
                    head.y -= 1;
                    break;
                case 'down':
                    head.y += 1;
                    break;
                case 'left':
                    head.x -= 1;
                    break;
                case 'right':
                    head.x += 1;
                    break;
            }
            snake.unshift(head);

            if (head.x === food.x && head.y === food.y) {
                generateFood();
                score += 10;
                updateScore();
            } else {
                snake.pop();
            }

            if (isCollision(head)) {
                endGame();
                return;
   
